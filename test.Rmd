---
title: "First"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
carseats <- read.csv("./Dataset/Carseats.csv")

```

## Including Plots

You can also embed plots, for example:

```{r }
#install.packages("ISLR")
library("ISLR")
#install.packages("SmartEDA")
library("SmartEDA")
```

```{r }
# Overview of the data - Type = 1
ExpData(data=carseats,type=1)

# Structure of the data - Type = 2
ExpData(data=carseats,type=2)

```


```{r }
dim(carseats[is.null(carseats$Sales),])
sapply(colnames(carseats), is.null)
for (col in colnames(carseats)) {
  if (dim(carseats[is.null(carseats[col]),])[1] >0) {
    print(carseats[is.null(carseats[col]),])
  }
  else {
    print(paste(col, ": No hemos encontrado valores nulos"))
  }
  
}

```


```{r }
library(fitdistrplus)
visualiz <- function(D, title){
oldpar = par(mfrow = c(2,2), mar=c(2,2,2,2))
truehist(D, main = title)
abline(v = mean(D), col="red", lwd=3, lty=2);
abline(v = median(D), lwd=3, lty=2, col="blue");
qqnorm(D, main = title);qqline(D, col = 2 )
boxplot(D~carseats$ShelveLoc, main = title)
}
```


```{r }
visualiz(carseats$Price,  "precio")
```


```{r }
visualiz1 <- function(D1, D2, name1, name2, title){
oldpar = par(mfrow = c(2,2), mar=c(2,2,2,2))
truehist(D1, main = paste(name1," ", title))
abline(v = mean(D1), col="red", lwd=3, lty=2);
abline(v = median(D1), lwd=3, lty=2, col="blue");
qqnorm(D1, main = paste(name1, " ", title));qqline(D1, col = 2 )
truehist(D2, main = paste(name2," ", title))
abline(v = mean(D2), col="red", lwd=3, lty=2);
abline(v = median(D2), lwd=3, lty=2, col="blue");
qqnorm(D2, main = paste(name2," ", title)); qqline(D2, col = 2 )
}
```


```{r }
visualiz1(carseats$Price, carseats$CompPrice, "price", "price competition", "Price vs competition")
```


```{r}
library(ggplot2)
ggplot(data=carseats, aes(x=US, fill=as.factor(Urban)))+geom_bar(position = 'fill')+facet_wrap(~ShelveLoc)+ scale_fill_manual(values=c("#008000", "black"))

ggplot(data=carseats, aes(x=Education, fill=as.factor(US)))+geom_bar(position = 'fill')+facet_wrap(~ShelveLoc)+ scale_fill_manual(values=c("#008000", "black", "red"))

ggplot(data=carseats, aes(x=Education, fill=as.factor(ShelveLoc)))+geom_bar(position = 'fill')+facet_wrap(~US)+ scale_fill_manual(values=c("#008000", "black", "red"))
```


```{r}
colnames(carseats)
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
